<!doctype html>
<html>
  <head>
    <title>Knitpicker</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://unpkg.com/react@18.3/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18.3/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/sortablejs@1.15.3/Sortable.min.js"></script>
    <!-- https://fonts.google.com/icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=content_copy,drag_indicator,edit,palette,share,zoom_in" />
    <style>
      /* Style color inputs as circles */
      input[type="color" i] {
        border-radius: 50%;
        inline-size: 30px;
        block-size: 30px;
        border-width: 1px;
        border-style: solid;
        border-color: rgb(153, 153, 153);
      }
      input[type="color" i]::-webkit-color-swatch,
      input[type="color" i]::-moz-color-swatch {
        border-radius: 50%;
      }
    </style>
  </head>

  <body>
    <svg style="display: none;" width="24px" height="24px">
      <defs>
        <symbol id="stitch" viewBox="0 0 24 24">
          <path d="M0 0 L 12 6 L 24 0 L 24 18 L 12 24 L 0 18 z M 12 6 L 12 24"/>
        </symbol>
      </defs>
    </svg>

    <div id="appContainer"></div>

    <script src="app.js"></script>
    <script>
      const params = new URLSearchParams(window.location.search)

      // Initialize custom colors
      const customColors = {}
      for (const [key, value] of params.entries()) {
        if (key.startsWith('color_')) {
          const colorKey = key.substring(6) // Remove 'color_' prefix
          customColors[colorKey] = value
        }
      }

      // Initialize textarea from URL parameter or default
      (async () => {
        if (params.has('stitches')) {
          const input = params.get('stitches')
          return decodeGzip(input).catch(() => {
            // If the input fails to decode, use it as is.
            return input
          })
        } else {
          return "A A A B A A A B\nA A B A A A B A\nA B A A A B A A\nB A A A B A A A\n"
        }
      })().then((defaultInput) => {
        ReactDOM.createRoot(
          document.getElementById('appContainer')
        ).render(
          createElement(App, {
            defaultInput,
            defaultCustomColors: customColors
          })
        )
      })
    </script>
  </body>
</html>
